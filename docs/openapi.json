{"openapi":"3.0.0","info":{"title":"LLM Test Generator","description":"Generate and grade educational tests using LLMs","version":"0.1.0"},"paths":{"/health":{"get":{"tags":["health"],"summary":"Health Check","description":"Health check endpoint.\n\nReturns service status and version.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/api/grade":{"post":{"tags":["grading"],"summary":"Grade Exam","description":"Grade student answers against exam answer keys.\n\nArgs:\n    request: GradeRequest with exam_id and student answers\n\nReturns:\n    GradeResponse with summary and per-question results\n\nRaises:\n    HTTPException: If exam not found or grading fails","operationId":"grade_exam_api_grade_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GradeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GradeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/generate":{"post":{"tags":["generation"],"summary":"Generate Exam","description":"Generate an exam from Markdown content.\n\nArgs:\n    request: GenerateRequest with markdown content and optional config\n\nReturns:\n    Generated Exam with questions\n\nRaises:\n    HTTPException: If generation fails","operationId":"generate_exam_api_generate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GenerateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Exam-Output"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/upload":{"post":{"tags":["files"],"summary":"Upload File","description":"Upload a Markdown file for exam generation.\n\nArgs:\n    file: Markdown file (.md)\n\nReturns:\n    File information and path","operationId":"upload_file_api_upload_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_api_upload_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/files":{"get":{"tags":["files"],"summary":"List Files","description":"List all uploaded Markdown files.\n\nReturns:\n    List of uploaded files with metadata","operationId":"list_files_api_files_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/files/{filename}":{"get":{"tags":["files"],"summary":"Get File Content","description":"Get content of an uploaded file.\n\nArgs:\n    filename: Name of the file\n\nReturns:\n    File content","operationId":"get_file_content_api_files__filename__get","parameters":[{"name":"filename","in":"path","required":true,"schema":{"type":"string","title":"Filename"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/exams":{"get":{"tags":["exams"],"summary":"List Exams","description":"List all generated exams.\n\nReturns:\n    List of exams with metadata","operationId":"list_exams_api_exams_get","parameters":[{"name":"sort_by","in":"query","required":false,"schema":{"type":"string","description":"Sort by created|size|exam_id","default":"created","title":"Sort By"},"description":"Sort by created|size|exam_id"},{"name":"order","in":"query","required":false,"schema":{"type":"string","description":"Sort order asc|desc","default":"desc","title":"Order"},"description":"Sort order asc|desc"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number (1-based)","default":1,"title":"Page"},"description":"Page number (1-based)"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Items per page","default":10,"title":"Page Size"},"description":"Items per page"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/exams/{exam_id}":{"get":{"tags":["exams"],"summary":"Get Exam","description":"Get a specific exam by ID.\n\nArgs:\n    exam_id: Exam identifier\n\nReturns:\n    Full exam data","operationId":"get_exam_api_exams__exam_id__get","parameters":[{"name":"exam_id","in":"path","required":true,"schema":{"type":"string","title":"Exam Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/exams/import":{"post":{"tags":["exams"],"summary":"Import Exam","description":"Import an existing exam JSON and persist it.\n\nArgs:\n    exam: Exam payload to store\n\nReturns:\n    Stored exam","operationId":"import_exam_api_exams_import_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Exam-Input"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Exam-Output"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_upload_file_api_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_file_api_upload_post"},"Exam-Input":{"properties":{"exam_id":{"type":"string","title":"Exam Id","description":"Unique exam identifier"},"questions":{"items":{"$ref":"#/components/schemas/Question"},"type":"array","minItems":1,"title":"Questions","description":"List of questions"},"config_used":{"allOf":[{"$ref":"#/components/schemas/ExamConfig"}],"description":"Configuration used for generation"}},"type":"object","required":["exam_id","questions","config_used"],"title":"Exam","description":"Generated exam with questions."},"Exam-Output":{"properties":{"exam_id":{"type":"string","title":"Exam Id","description":"Unique exam identifier"},"questions":{"items":{"$ref":"#/components/schemas/Question"},"type":"array","minItems":1,"title":"Questions","description":"List of questions"},"config_used":{"allOf":[{"$ref":"#/components/schemas/ExamConfig"}],"description":"Configuration used for generation"}},"type":"object","required":["exam_id","questions","config_used"],"title":"Exam","description":"Generated exam with questions."},"ExamConfig":{"properties":{"single_choice_count":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Single Choice Count","description":"Exact number of single choice questions"},"multiple_choice_count":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Multiple Choice Count","description":"Exact number of multiple choice questions"},"open_ended_count":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Open Ended Count","description":"Exact number of open-ended questions"},"total_questions":{"type":"integer","maximum":100.0,"minimum":1.0,"title":"Total Questions","description":"Number of questions to generate","default":20},"single_choice_ratio":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Single Choice Ratio","description":"Ratio of single choice questions","default":0.5},"multiple_choice_ratio":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Multiple Choice Ratio","description":"Ratio of multiple choice questions","default":0.3},"open_ended_ratio":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Open Ended Ratio","description":"Ratio of open-ended questions","default":0.2},"difficulty":{"type":"string","enum":["easy","medium","hard","mixed"],"title":"Difficulty","description":"Question difficulty","default":"mixed"},"language":{"type":"string","enum":["en","ru"],"title":"Language","description":"Language for questions and prompts (en=English, ru=Russian)","default":"en"},"seed":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Seed","description":"Random seed for reproducibility"},"provider":{"type":"string","enum":["openai","yandex","local"],"title":"Provider","description":"LLM provider for generation/grading","default":"openai"},"model_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model Name","description":"Specific model to use for the provider"}},"type":"object","title":"ExamConfig","description":"Configuration used to generate an exam.\n\nSupports two input modes:\n1. Count-based (preferred): Specify exact counts for each question type\n2. Ratio-based (legacy): Specify ratios that sum to 1.0\n\nIf counts are provided, they take precedence and ratios are auto-calculated.\nIf ratios are provided, counts are auto-calculated from total_questions."},"GenerateRequest":{"properties":{"config":{"anyOf":[{"$ref":"#/components/schemas/ExamConfig"},{"type":"null"}],"description":"Exam generation configuration"},"markdown_content":{"type":"string","minLength":1,"title":"Markdown Content","description":"Markdown content for question generation"}},"type":"object","required":["markdown_content"],"title":"GenerateRequest","description":"Request to generate an exam."},"GradeRequest":{"properties":{"exam_id":{"type":"string","title":"Exam Id","description":"Exam identifier"},"answers":{"items":{"$ref":"#/components/schemas/StudentAnswer"},"type":"array","minItems":1,"title":"Answers","description":"Student answers"}},"type":"object","required":["exam_id","answers"],"title":"GradeRequest","description":"Request to grade exam answers."},"GradeResponse":{"properties":{"exam_id":{"type":"string","title":"Exam Id","description":"Exam identifier"},"summary":{"allOf":[{"$ref":"#/components/schemas/GradeSummary"}],"description":"Summary statistics"},"per_question":{"items":{"$ref":"#/components/schemas/QuestionResult"},"type":"array","title":"Per Question","description":"Per-question results"}},"type":"object","required":["exam_id","summary","per_question"],"title":"GradeResponse","description":"Response with grading results."},"GradeSummary":{"properties":{"total":{"type":"integer","minimum":0.0,"title":"Total","description":"Total questions"},"correct":{"type":"integer","minimum":0.0,"title":"Correct","description":"Number of correct answers"},"score_percent":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Score Percent","description":"Score percentage"}},"type":"object","required":["total","correct","score_percent"],"title":"GradeSummary","description":"Summary statistics for grading."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status","description":"Service status"},"version":{"type":"string","title":"Version","description":"API version","default":"0.1.0"}},"type":"object","required":["status"],"title":"HealthResponse","description":"Health check response."},"Question":{"properties":{"id":{"type":"string","title":"Id","description":"Unique question identifier"},"type":{"type":"string","enum":["single_choice","multiple_choice","open_ended"],"title":"Type","description":"Question type"},"stem":{"type":"string","minLength":1,"title":"Stem","description":"Question text"},"options":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Options","description":"Answer options (not used for open_ended)"},"correct":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Correct","description":"Indices of correct answers (not used for open_ended)"},"reference_answer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reference Answer","description":"Reference answer for open_ended questions"},"rubric":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Rubric","description":"Grading criteria for open_ended questions"},"source_refs":{"items":{"$ref":"#/components/schemas/SourceReference"},"type":"array","title":"Source Refs","description":"Source material references"},"meta":{"allOf":[{"$ref":"#/components/schemas/QuestionMeta"}],"description":"Question metadata"}},"type":"object","required":["id","type","stem"],"title":"Question","description":"Represents a single test question.\n\nFor single_choice: correct contains exactly one index.\nFor multiple_choice: correct contains one or more indices.\nFor open_ended: options/correct are None, reference_answer and rubric are used."},"QuestionMeta":{"properties":{"difficulty":{"type":"string","enum":["easy","medium","hard"],"title":"Difficulty","description":"Question difficulty","default":"medium"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Content tags"}},"type":"object","title":"QuestionMeta","description":"Metadata for a question."},"QuestionResult":{"properties":{"question_id":{"type":"string","title":"Question Id","description":"Question identifier"},"is_correct":{"type":"boolean","title":"Is Correct","description":"Whether answer is correct"},"expected":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Expected","description":"Expected correct indices (for choice questions)"},"given":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Given","description":"Student's answer indices (for choice questions)"},"given_text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Given Text","description":"Student's text answer (for open_ended)"},"partial_credit":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Partial Credit","description":"Partial credit (0.0-1.0)","default":0.0},"feedback":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Feedback","description":"Detailed feedback (for open_ended)"}},"type":"object","required":["question_id","is_correct"],"title":"QuestionResult","description":"Grading result for a single question."},"SourceReference":{"properties":{"file":{"type":"string","title":"File","description":"Source Markdown file path"},"heading":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Heading","description":"Section heading"},"start":{"type":"integer","minimum":0.0,"title":"Start","description":"Start character position"},"end":{"type":"integer","minimum":0.0,"title":"End","description":"End character position"}},"type":"object","required":["file","start","end"],"title":"SourceReference","description":"Reference to source material in Markdown file."},"StudentAnswer":{"properties":{"question_id":{"type":"string","title":"Question Id","description":"Question identifier"},"choice":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Choice","description":"Selected answer indices (for single/multiple choice)"},"text_answer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text Answer","description":"Text answer (for open_ended)"}},"type":"object","required":["question_id"],"title":"StudentAnswer","description":"Student's answer to a question."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}